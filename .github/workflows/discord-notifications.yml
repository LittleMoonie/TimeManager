name: Discord Notifications - PR/Push Events

on:
  push:
    branches: [ main, develop, feat/*, fix/*, chore/*, docs/*, refactor/*, test/*, perf/*, ci/*, build/* ]
  pull_request:
    branches: [ main, develop, feat/*, fix/*, chore/*, docs/*, refactor/*, test/*, perf/*, ci/*, build/* ]
    types: [ opened, synchronize, reopened, closed ]
  pull_request_review:
    types: [ submitted, dismissed ]

jobs:
  notify-discord:
    name: Notify Discord
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Notify Discord - Push/PR Events
        if: github.event_name == 'push' || github.event_name == 'pull_request'
        uses: sarisia/actions-status-discord@v1
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_PR_URL }}
          title: |
            ðŸš€ **${{ github.event_name == 'push' && 'Push Event' || 'Pull Request' }}**
            Repository: **${{ github.repository }}**
          description: |
            **Branch:** `${{ github.ref_name }}`
            **Commit:** `${{ github.sha }}`
            **Author:** ${{ github.actor }}
            **Event:** `${{ github.event_name }}`
            ${{ github.event_name == 'pull_request' && format('**PR #{0}:** {1}', github.event.number, github.event.pull_request.title) || '' }}
            ${{ github.event_name == 'pull_request' && github.event.pull_request.body && format('**Description:** {0}', github.event.pull_request.body) || '' }}
          color: ${{ github.event_name == 'push' && '65280' || github.event.action == 'opened' && '3447003' || github.event.action == 'closed' && github.event.pull_request.merged && '65280' || github.event.action == 'closed' && '15158332' || '16776960' }}
          username: GitHub Actions
          avatar_url: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png

      - name: Notify Discord - PR Review Events
        if: github.event_name == 'pull_request_review'
        uses: sarisia/actions-status-discord@v1
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_PR_URL }}
          title: |
            ðŸ‘€ **Pull Request Review**
            Repository: **${{ github.repository }}**
          description: |
            **Reviewer:** ${{ github.actor }}
            **PR #${{ github.event.pull_request.number }}:** ${{ github.event.pull_request.title }}
            **State:** ${{ github.event.review.state }}
            ${{ github.event.review.body && format('**Review Comment:** {0}', github.event.review.body) || '' }}
          color: ${{ github.event.review.state == 'approved' && '65280' || github.event.review.state == 'changes_requested' && '15158332' || '16776960' }}
          username: GitHub Actions
          avatar_url: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png

