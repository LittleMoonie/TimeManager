# üê≥ GoGoTime Web - Dev Dockerfile
FROM node:24-alpine AS base

# 1Ô∏è‚É£ Build tools
RUN apk add --no-cache curl g++ make python3

WORKDIR /app

# 2Ô∏è‚É£ Pin Yarn
RUN corepack enable && corepack prepare yarn@stable --activate

# Copy dependency manifests first (cache layer)
COPY yarn.lock ./
COPY package.json ./

# 4Ô∏è‚É£ Install dependencies (immutable but fallback-safe)
RUN yarn install --immutable || yarn install

# 5Ô∏è‚É£ Copy source
COPY . .

# 6Ô∏è‚É£ Expose Vite port
ENV NODE_ENV=development
EXPOSE 3000

# 7Ô∏è‚É£ Default dev command
CMD ["yarn", "dev"]
